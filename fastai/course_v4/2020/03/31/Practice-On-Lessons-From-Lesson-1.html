<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Practice using the Lesson 1 notebook | Redditech’s Learn Deep Learning Blog</title>
<meta name="generator" content="Jekyll v4.0.0" />
<meta property="og:title" content="Practice using the Lesson 1 notebook" />
<meta name="author" content="Nissan Dookeran" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Notes diving deeper into the Lesson 1 notebook from V4 of the Practical Deep Learning for Coders course" />
<meta property="og:description" content="Notes diving deeper into the Lesson 1 notebook from V4 of the Practical Deep Learning for Coders course" />
<link rel="canonical" href="https://nissan.github.io/learn-deeplearning-blog/fastai/course_v4/2020/03/31/Practice-On-Lessons-From-Lesson-1.html" />
<meta property="og:url" content="https://nissan.github.io/learn-deeplearning-blog/fastai/course_v4/2020/03/31/Practice-On-Lessons-From-Lesson-1.html" />
<meta property="og:site_name" content="Redditech’s Learn Deep Learning Blog" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2020-03-31T00:00:00-05:00" />
<script type="application/ld+json">
{"author":{"@type":"Person","name":"Nissan Dookeran"},"description":"Notes diving deeper into the Lesson 1 notebook from V4 of the Practical Deep Learning for Coders course","@type":"BlogPosting","headline":"Practice using the Lesson 1 notebook","dateModified":"2020-03-31T00:00:00-05:00","datePublished":"2020-03-31T00:00:00-05:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://nissan.github.io/learn-deeplearning-blog/fastai/course_v4/2020/03/31/Practice-On-Lessons-From-Lesson-1.html"},"url":"https://nissan.github.io/learn-deeplearning-blog/fastai/course_v4/2020/03/31/Practice-On-Lessons-From-Lesson-1.html","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/learn-deeplearning-blog/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="https://nissan.github.io/learn-deeplearning-blog/feed.xml" title="Redditech's Learn Deep Learning Blog" /><link rel="shortcut icon" type="image/x-icon" href="/learn-deeplearning-blog/images/favicon.ico"><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Practice using the Lesson 1 notebook | Redditech’s Learn Deep Learning Blog</title>
<meta name="generator" content="Jekyll v4.0.0" />
<meta property="og:title" content="Practice using the Lesson 1 notebook" />
<meta name="author" content="Nissan Dookeran" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Notes diving deeper into the Lesson 1 notebook from V4 of the Practical Deep Learning for Coders course" />
<meta property="og:description" content="Notes diving deeper into the Lesson 1 notebook from V4 of the Practical Deep Learning for Coders course" />
<link rel="canonical" href="https://nissan.github.io/learn-deeplearning-blog/fastai/course_v4/2020/03/31/Practice-On-Lessons-From-Lesson-1.html" />
<meta property="og:url" content="https://nissan.github.io/learn-deeplearning-blog/fastai/course_v4/2020/03/31/Practice-On-Lessons-From-Lesson-1.html" />
<meta property="og:site_name" content="Redditech’s Learn Deep Learning Blog" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2020-03-31T00:00:00-05:00" />
<script type="application/ld+json">
{"author":{"@type":"Person","name":"Nissan Dookeran"},"description":"Notes diving deeper into the Lesson 1 notebook from V4 of the Practical Deep Learning for Coders course","@type":"BlogPosting","headline":"Practice using the Lesson 1 notebook","dateModified":"2020-03-31T00:00:00-05:00","datePublished":"2020-03-31T00:00:00-05:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://nissan.github.io/learn-deeplearning-blog/fastai/course_v4/2020/03/31/Practice-On-Lessons-From-Lesson-1.html"},"url":"https://nissan.github.io/learn-deeplearning-blog/fastai/course_v4/2020/03/31/Practice-On-Lessons-From-Lesson-1.html","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->

<link href="https://unpkg.com/@primer/css/dist/primer.css" rel="stylesheet" />
<link rel="stylesheet" href="//use.fontawesome.com/releases/v5.0.7/css/all.css"><link type="application/atom+xml" rel="alternate" href="https://nissan.github.io/learn-deeplearning-blog/feed.xml" title="Redditech's Learn Deep Learning Blog" />

<script>
function wrap_img(fn) {
    if (document.attachEvent ? document.readyState === "complete" : document.readyState !== "loading") {
        var elements = document.querySelectorAll(".post img");
        Array.prototype.forEach.call(elements, function(el, i) {
            if (el.getAttribute("title")) {
                const caption = document.createElement('figcaption');
                var node = document.createTextNode(el.getAttribute("title"));
                caption.appendChild(node);
                const wrapper = document.createElement('figure');
                wrapper.className = 'image';
                el.parentNode.insertBefore(wrapper, el);
                el.parentNode.removeChild(el);
                wrapper.appendChild(el);
                wrapper.appendChild(caption);
            }
        });
    } else { document.addEventListener('DOMContentLoaded', fn); }
}
window.onload = wrap_img;
</script>

<script>
    document.addEventListener("DOMContentLoaded", function(){
    // add link icon to anchor tags
    var elem = document.querySelectorAll(".anchor-link")
    elem.forEach(e => (e.innerHTML = '<i class="fas fa-link fa-xs"></i>'));
    });
</script>
</head><body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/learn-deeplearning-blog/">Redditech&#39;s Learn Deep Learning Blog</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/learn-deeplearning-blog/about/">About Me</a><a class="page-link" href="/learn-deeplearning-blog/search/">Search</a><a class="page-link" href="/learn-deeplearning-blog/categories/">Tags</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Practice using the Lesson 1 notebook</h1><p class="page-description">Notes diving deeper into the Lesson 1 notebook from V4 of the Practical Deep Learning for Coders course</p><p class="post-meta post-meta-title"><time class="dt-published" datetime="2020-03-31T00:00:00-05:00" itemprop="datePublished">
        Mar 31, 2020
      </time>• 
          <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <span class="p-author h-card" itemprop="name">Nissan Dookeran</span></span>
       • <span class="read-time" title="Estimated read time">
    
    
      8 min read
    
</span></p>

    
      <p class="category-tags"><i class="fas fa-tags category-tags-icon"></i></i> 
      
        <a class="category-tags-link" href="/learn-deeplearning-blog/categories/#fastai">fastai</a>
        &nbsp;
      
        <a class="category-tags-link" href="/learn-deeplearning-blog/categories/#course_v4">course_v4</a>
        
      
      </p>
    

    
      
        <div class="pb-5 d-flex flex-wrap flex-justify-end">
          <div class="px-2">

    <a href="https://github.com/nissan/learn-deeplearning-blog/tree/master/_notebooks/2020-03-31-Practice-On-Lessons-From-Lesson-1.ipynb" role="button" target="_blank">
<img class="notebook-badge-image" src="/learn-deeplearning-blog/assets/badges/github.svg" alt="View On GitHub">
    </a>
</div>

          <div class="px-2">
    <a href="https://mybinder.org/v2/gh/nissan/learn-deeplearning-blog/master?filepath=_notebooks%2F2020-03-31-Practice-On-Lessons-From-Lesson-1.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/learn-deeplearning-blog/assets/badges/binder.svg" alt="Open In Binder"/>
    </a>
</div>

          <div class="px-2">
    <a href="https://colab.research.google.com/github/nissan/learn-deeplearning-blog/blob/master/_notebooks/2020-03-31-Practice-On-Lessons-From-Lesson-1.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/learn-deeplearning-blog/assets/badges/colab.svg" alt="Open In Colab"/>
    </a>
</div>
        </div>
      </header>

  <div class="post-content e-content" itemprop="articleBody">
    <ul class="section-nav">
</ul><!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2020-03-31-Practice-On-Lessons-From-Lesson-1.ipynb
-->

<div class="container" id="notebook-container">
        
    
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>From Lesson 1 of the V4 course currently being run we're using copies of the notebook code embedded in their new book. So below are my experiments from what I learnt here, starting from scratch but drawing heavily from their textbook code. I run this locally on Windows 10 (I can see Jeremy's eye rolling if he reads this since he recommended against this for beginners) but in my defense I did do the course last year and had my laptop configured with V1 of Fastai running so thought I'd see where the stress points were, but to keep productive I also run on Google Collab which is honestly much easier. As a caveat, I'm writing this article while running Jupyter Notebook on the Windows 10 environment so if some code looks slightly modified I'll try to mention explicitly this is a Win10 specific change. Now, on to the experimentation.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>First if you're running this locally make sure you have the "Trusted" button enable for this notebook.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now we're going to make sure fastai is installed into my local environment</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="n">fastai2</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Requirement already satisfied: fastai2 in c:\users\nissan.dookeran\documents\github\fastai2 (0.0.16)
Requirement already satisfied: fastcore in c:\tools\anaconda3\envs\fastai2\lib\site-packages (from fastai2) (0.1.16)
Requirement already satisfied: torch&gt;=1.3.0 in c:\tools\anaconda3\envs\fastai2\lib\site-packages (from fastai2) (1.4.0)
Requirement already satisfied: torchvision&gt;=0.5 in c:\tools\anaconda3\envs\fastai2\lib\site-packages (from fastai2) (0.5.0)
Requirement already satisfied: matplotlib in c:\tools\anaconda3\envs\fastai2\lib\site-packages (from fastai2) (3.1.3)
Requirement already satisfied: pandas in c:\tools\anaconda3\envs\fastai2\lib\site-packages (from fastai2) (1.0.3)
Requirement already satisfied: requests in c:\tools\anaconda3\envs\fastai2\lib\site-packages (from fastai2) (2.23.0)
Requirement already satisfied: pyyaml in c:\tools\anaconda3\envs\fastai2\lib\site-packages (from fastai2) (5.3.1)
Requirement already satisfied: fastprogress&gt;=0.1.22 in c:\tools\anaconda3\envs\fastai2\lib\site-packages (from fastai2) (0.2.2)
Requirement already satisfied: pillow in c:\tools\anaconda3\envs\fastai2\lib\site-packages (from fastai2) (7.0.0)
Requirement already satisfied: scikit-learn in c:\tools\anaconda3\envs\fastai2\lib\site-packages (from fastai2) (0.22.1)
Requirement already satisfied: scipy in c:\tools\anaconda3\envs\fastai2\lib\site-packages (from fastai2) (1.4.1)
Requirement already satisfied: spacy in c:\tools\anaconda3\envs\fastai2\lib\site-packages (from fastai2) (2.1.8)
Requirement already satisfied: numpy in c:\tools\anaconda3\envs\fastai2\lib\site-packages (from fastcore-&gt;fastai2) (1.18.1)
Requirement already satisfied: six in c:\tools\anaconda3\envs\fastai2\lib\site-packages (from torchvision&gt;=0.5-&gt;fastai2) (1.14.0)
Requirement already satisfied: kiwisolver&gt;=1.0.1 in c:\tools\anaconda3\envs\fastai2\lib\site-packages (from matplotlib-&gt;fastai2) (1.1.0)
Requirement already satisfied: cycler&gt;=0.10 in c:\tools\anaconda3\envs\fastai2\lib\site-packages (from matplotlib-&gt;fastai2) (0.10.0)
Requirement already satisfied: python-dateutil&gt;=2.1 in c:\tools\anaconda3\envs\fastai2\lib\site-packages (from matplotlib-&gt;fastai2) (2.8.1)
Requirement already satisfied: pyparsing!=2.0.4,!=2.1.2,!=2.1.6,&gt;=2.0.1 in c:\tools\anaconda3\envs\fastai2\lib\site-packages (from matplotlib-&gt;fastai2) (2.4.6)
Requirement already satisfied: pytz&gt;=2017.2 in c:\tools\anaconda3\envs\fastai2\lib\site-packages (from pandas-&gt;fastai2) (2019.3)
Requirement already satisfied: chardet&lt;4,&gt;=3.0.2 in c:\tools\anaconda3\envs\fastai2\lib\site-packages (from requests-&gt;fastai2) (3.0.4)
Requirement already satisfied: idna&lt;3,&gt;=2.5 in c:\tools\anaconda3\envs\fastai2\lib\site-packages (from requests-&gt;fastai2) (2.9)
Requirement already satisfied: certifi&gt;=2017.4.17 in c:\tools\anaconda3\envs\fastai2\lib\site-packages (from requests-&gt;fastai2) (2019.11.28)
Requirement already satisfied: urllib3!=1.25.0,!=1.25.1,&lt;1.26,&gt;=1.21.1 in c:\tools\anaconda3\envs\fastai2\lib\site-packages (from requests-&gt;fastai2) (1.25.8)
Requirement already satisfied: joblib&gt;=0.11 in c:\tools\anaconda3\envs\fastai2\lib\site-packages (from scikit-learn-&gt;fastai2) (0.14.1)
Requirement already satisfied: srsly&lt;1.1.0,&gt;=0.0.6 in c:\tools\anaconda3\envs\fastai2\lib\site-packages (from spacy-&gt;fastai2) (0.1.0)
Requirement already satisfied: murmurhash&lt;1.1.0,&gt;=0.28.0 in c:\tools\anaconda3\envs\fastai2\lib\site-packages (from spacy-&gt;fastai2) (1.0.2)
Requirement already satisfied: blis&lt;0.3.0,&gt;=0.2.2 in c:\tools\anaconda3\envs\fastai2\lib\site-packages (from spacy-&gt;fastai2) (0.2.4)
Requirement already satisfied: plac&lt;1.0.0,&gt;=0.9.6 in c:\tools\anaconda3\envs\fastai2\lib\site-packages (from spacy-&gt;fastai2) (0.9.6)
Requirement already satisfied: thinc&lt;7.1.0,&gt;=7.0.8 in c:\tools\anaconda3\envs\fastai2\lib\site-packages (from spacy-&gt;fastai2) (7.0.8)
Requirement already satisfied: preshed&lt;2.1.0,&gt;=2.0.1 in c:\tools\anaconda3\envs\fastai2\lib\site-packages (from spacy-&gt;fastai2) (2.0.1)
Requirement already satisfied: wasabi&lt;1.1.0,&gt;=0.2.0 in c:\tools\anaconda3\envs\fastai2\lib\site-packages (from spacy-&gt;fastai2) (0.2.2)
Requirement already satisfied: cymem&lt;2.1.0,&gt;=2.0.2 in c:\tools\anaconda3\envs\fastai2\lib\site-packages (from spacy-&gt;fastai2) (2.0.2)
Requirement already satisfied: setuptools in c:\tools\anaconda3\envs\fastai2\lib\site-packages (from kiwisolver&gt;=1.0.1-&gt;matplotlib-&gt;fastai2) (46.1.1.post20200323)
Requirement already satisfied: tqdm&lt;5.0.0,&gt;=4.10.0 in c:\tools\anaconda3\envs\fastai2\lib\site-packages (from thinc&lt;7.1.0,&gt;=7.0.8-&gt;spacy-&gt;fastai2) (4.43.0)
Note: you may need to restart the kernel to use updated packages.
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now in the notebook and the V4 course repo, Jeremy hides alot of the guts of getting things up and running with</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">utils</span> <span class="kn">import</span> <span class="o">*</span> <span class="c1">#this will crash if you run it outside the folder since `utils.py` is in the root folder of the notebooks</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>But since I like to dig into things I'm going to try to parse the <code>utils.py</code> file and pull out just the pieces we need to get Lesson 1 stuff up and running</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">fastai2.vision.all</span> <span class="kn">import</span> <span class="o">*</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>I also want to test my environment to make sure I have a Nvidia GPU and probe for some details on it</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">torch</span>
<span class="n">torch</span><span class="o">.</span><span class="n">cuda</span><span class="o">.</span><span class="n">device</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">torch</span><span class="o">.</span><span class="n">cuda</span><span class="o">.</span><span class="n">get_device_name</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>'GeForce GTX 1050'</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">torch.cuda</span>
<span class="k">if</span> <span class="n">torch</span><span class="o">.</span><span class="n">cuda</span><span class="o">.</span><span class="n">is_available</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">'PyTorch found cuda'</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">'PyTorch could not find cuda'</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>PyTorch found cuda
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>There's a block of code in the notebook that executes a learner on images data of both cats and dogs and their breeds. I'm segmenting that code below and putting notes on each</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>First he gets the data from the built in <code>URLS</code> object for <code>PETS</code> data which is a simple Amazon S3 storage bucket location containing what looks like either the originally or slightly modified copy of <a href="https://www.robots.ox.ac.uk/~vgg/data/pets/">The Oxford-IIIT Pet Dataset</a></p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">URLs</span><span class="o">.</span><span class="n">PETS</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>https://s3.amazonaws.com/fast-ai-imageclas/oxford-iiit-pet.tgz
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>So we use a method <code>untar_data</code> to decompress this into our local <code>images</code> folder. In the next block if you uncomment the code and press <code>Shift-Tab</code> 3 (or 4 times for a pop out window) you can see the documentation on the function and the parameters it takes</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">untar_data</span> <span class="c1">#Press `Enter` to see some info or use `Shift+Tab` 3 or 4 times to see more formatted documentation</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">path</span> <span class="o">=</span> <span class="n">untar_data</span><span class="p">(</span><span class="n">URLs</span><span class="o">.</span><span class="n">PETS</span><span class="p">)</span><span class="o">/</span><span class="s1">'images'</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>So this had me scratching for awhile when I read the notebook but then in the video Jeremy explained the need for this function. Apparently because it is a mixture of both cats and dogs and their breeds, the way to identify data as being for a cat is to Capitalize The First Letter For Any Cat Breed. So the function below would be reused when classifying data as a Cat before going deeper into identifying its breed.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">is_cat</span><span class="p">(</span><span class="n">x</span><span class="p">):</span> <span class="k">return</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">isupper</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The <code>ImageDataLoaders</code> function is handy as it has a variety of extensions to make loading from various image sources much easier. FastAI has this concept of a <code>DataLoader</code> that holds the data we're going to train and validate our model on. Because I'm running this on Windows 10, I had to add an additional parameter of <code>num_workers=0</code> to the call to make sure it doesn't crash. For Linux users, you can safely remove this call.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ImageDataLoaders</span><span class="o">.</span><span class="n">from_</span> <span class="c1">#press Tab once to see all possible calls</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dls</span> <span class="o">=</span> <span class="n">ImageDataLoaders</span><span class="o">.</span><span class="n">from_name_func</span><span class="p">(</span>
    <span class="n">path</span><span class="p">,</span> <span class="n">get_image_files</span><span class="p">(</span><span class="n">path</span><span class="p">),</span> <span class="n">valid_pct</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span>
    <span class="n">label_func</span><span class="o">=</span><span class="n">is_cat</span><span class="p">,</span> <span class="n">item_tfms</span><span class="o">=</span><span class="n">Resize</span><span class="p">(</span><span class="mi">224</span><span class="p">),</span> <span class="n">num_workers</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>So now we're going to call the learner that will train the model to recognise the various cats and dogs breeds in our model using the <a href="https://arxiv.org/abs/1512.03385">ResNet34</a> pre-trained model. A pre-trained model is a very cool concept. Normally to start training a series of weights are chosen at random and over time are changed to better match a specific set of data. These weights are re-usable since basically it lets us jumpstart training a new, related dataset as these pre-trained series of weights are a better starting point than "random" for the new more niche subset of related data. Here we also specifiy the metric we're using as a measure of accuracy, fastai defines one for us that's useful, appropriately called <code>error_rate</code></p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">error_rate</span> <span class="c1"># Press Shift+Tab 3 times to see the documentation on this</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span> <span class="o">=</span> <span class="n">cnn_learner</span><span class="p">(</span><span class="n">dls</span><span class="p">,</span> <span class="n">resnet34</span><span class="p">,</span> <span class="n">metrics</span><span class="o">=</span><span class="n">error_rate</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Fast.ai V2 also introduced this nice method called <code>fine_tune</code> which basially runs a cycle of training again using a learning rate it has pre-determined as best for training to "fine tune" the model to produce better accuracy. I won't propose to understand it fully yet, but from what I know it freezes a fixed number of the hidden layers of the pre-trained model, and unfreezes the last few layers so their weights can be changed to better match the niche dataset. The logic is sound as the first set of layers would already be really good at recognising general features common in all images of the superset, but the last few layers can now be fine tuned to match the explicit features in the specific classifications of the niche dataset we are presenting for training in this model. As I learn I may write more about how I understand this function to work and append this post to match what I learn. Note, this step might take some time to execute depending on the speed and memory of the GPU you have running. Google Collab would take about 5 minutes. My local laptop running Windows 10 takes a little longer.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">fine_tune</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: left;">
      <th>epoch</th>
      <th>train_loss</th>
      <th>valid_loss</th>
      <th>error_rate</th>
      <th>time</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>0.171001</td>
      <td>0.023034</td>
      <td>0.008119</td>
      <td>04:04</td>
    </tr>
  </tbody>
</table>
</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: left;">
      <th>epoch</th>
      <th>train_loss</th>
      <th>valid_loss</th>
      <th>error_rate</th>
      <th>time</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>0.053063</td>
      <td>0.024095</td>
      <td>0.006766</td>
      <td>03:59</td>
    </tr>
  </tbody>
</table>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>So now we have a trained model that looks like it has a pretty low error rate and we want to test it with something it hasn't seen before. This library in the next code block was added early in V3 of the course and is more prominent in V4 and lets you put GUI elements you're used to in a normal application (like a file uploader) into the notebook. I did a quick web search for a cat, downloaded that file and used it here to test.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">ipywidgets</span> <span class="kn">import</span> <span class="n">widgets</span>
<span class="n">uploader</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">FileUpload</span><span class="p">()</span>
<span class="n">uploader</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The next block of code simply looks at the image we loaded, passes it to our model for an evaluation of whether or not it thinks it's a cat. I'd recommend having both a dog and a cat image available to test on your own</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">img</span> <span class="o">=</span> <span class="n">PILImage</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">uploader</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">is_cat</span><span class="p">,</span><span class="n">_</span><span class="p">,</span><span class="n">probs</span> <span class="o">=</span> <span class="n">learn</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Is this a cat?: </span><span class="si">{</span><span class="n">is_cat</span><span class="si">}</span><span class="s2">."</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Probability it's a cat: </span><span class="si">{</span><span class="n">probs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">item</span><span class="p">()</span><span class="si">:</span><span class="s2">.6f</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Is this a cat?: True.
Probability it's a cat: 1.000000
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>And there you go. That simple. You're now a deep learning practitioner like me so celebrate the accomplishment. 
Hopefully you feel less like this:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>
</p>
<center>
    <iframe width="560" height="315" src="https://www.youtube.com/embed/ygFoN3hKi20" frameborder="0" allowfullscreen=""></iframe>
</center>


</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>And more like this:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>
</p>
<center>
    <iframe width="560" height="315" src="https://www.youtube.com/embed/535Zy_rf4NU" frameborder="0" allowfullscreen=""></iframe>
</center>


</div>
</div>
</div>
</div>



  </div><!-- from https://github.com/utterance/utterances -->
<script src="https://utteranc.es/client.js"
        repo="nissan/learn-deeplearning-blog"
        issue-term="title"
        label="blogpost-comment"
        theme="github-light"
        crossorigin="anonymous"
        async>
</script><a class="u-url" href="/learn-deeplearning-blog/fastai/course_v4/2020/03/31/Practice-On-Lessons-From-Lesson-1.html" hidden></a>
</article>
      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/learn-deeplearning-blog/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="/learn-deeplearning-blog/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/learn-deeplearning-blog/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Subscribe</span>
          </a>
        </p>
      </div>
      <div class="footer-col">
        <p>My blog as I learn more about deep learning.</p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"><li><a rel="me" href="https://github.com/nissan" title="nissan"><svg class="svg-icon grey"><use xlink:href="/learn-deeplearning-blog/assets/minima-social-icons.svg#github"></use></svg></a></li><li><a rel="me" href="https://twitter.com/redditech" title="redditech"><svg class="svg-icon grey"><use xlink:href="/learn-deeplearning-blog/assets/minima-social-icons.svg#twitter"></use></svg></a></li></ul>
</div>

  </div>

</footer>
</body>

</html>
